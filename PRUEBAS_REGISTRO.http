/**
 * Ejemplo de uso de los endpoints de registro y verificación de email
 * 
 * Flujo completo de prueba
 */

// ============================================
// PASO 1: Registrar un usuario
// ============================================
// POST http://localhost:3000/auth/register
// Content-Type: application/json

{
  "email": "juan@example.com",
  "username": "juan.perez",
  "password": "SecurePassword123!"
}

// Respuesta esperada:
// {
//   "message": "Usuario registrado exitosamente. Se ha enviado un código de verificación al correo.",
//   "email": "juan@example.com"
// }

// En la consola del backend, verás:
// ╔════════════════════════════════════════╗
// ║  CÓDIGO DE VERIFICACIÓN DE CORREO     ║
// ╚════════════════════════════════════════╝
// Email: juan@example.com
// Código: 4892 (ejemplo)
// Válido por: 15 minutos

// ============================================
// PASO 2: Verificar el correo con el código
// ============================================
// POST http://localhost:3000/auth/verify-email
// Content-Type: application/json

{
  "email": "juan@example.com",
  "code": "4892"
}

// Respuesta esperada:
// {
//   "message": "Correo verificado exitosamente",
//   "email": "juan@example.com",
//   "verified": true
// }

// ============================================
// PASO 3: Iniciar sesión
// ============================================
// POST http://localhost:3000/auth/login
// Content-Type: application/json

{
  "email": "juan@example.com",
  "password": "SecurePassword123!"
}

// Respuesta esperada:
// {
//   "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
//   "usuario": {
//     "id": 1,
//     "email": "juan@example.com",
//     "username": "juan.perez",
//     "displayName": "juan.perez",
//     "roles": []
//   }
// }

// ============================================
// CASOS DE ERROR
// ============================================

// --- Error 1: Código incorrecto ---
// POST http://localhost:3000/auth/verify-email
{
  "email": "juan@example.com",
  "code": "1111"
}
// Respuesta: 400 Bad Request
// {
//   "message": "Código incorrecto. Tienes 2 intentos restantes.",
//   "error": "Bad Request",
//   "statusCode": 400
// }

// --- Error 2: Código expirado ---
// Si pasan más de 15 minutos después del registro
// POST http://localhost:3000/auth/verify-email
{
  "email": "juan@example.com",
  "code": "4892"
}
// Respuesta: 400 Bad Request
// {
//   "message": "El código de verificación ha expirado",
//   "error": "Bad Request",
//   "statusCode": 400
// }

// --- Error 3: Email no verificado para login ---
// Si intentas login sin verificar email
// POST http://localhost:3000/auth/login
{
  "email": "juan@example.com",
  "password": "SecurePassword123!"
}
// Respuesta: 401 Unauthorized
// {
//   "message": "Debes verificar tu correo antes de iniciar sesión",
//   "error": "Unauthorized",
//   "statusCode": 401
// }

// --- Error 4: Email duplicado en registro ---
// POST http://localhost:3000/auth/register
{
  "email": "juan@example.com",
  "username": "otro_usuario",
  "password": "SecurePassword123!"
}
// Respuesta: 409 Conflict
// {
//   "message": "El email o usuario ya está registrado",
//   "error": "Conflict",
//   "statusCode": 409
// }

// ============================================
// REENVIAR CÓDIGO
// ============================================
// POST http://localhost:3000/auth/resend-code
// Content-Type: application/json

{
  "email": "juan@example.com"
}

// Respuesta esperada:
// {
//   "message": "Se ha enviado un nuevo código de verificación al correo",
//   "email": "juan@example.com"
// }

// En la consola del backend, verás un nuevo código
// Código anterior se marca como usado
